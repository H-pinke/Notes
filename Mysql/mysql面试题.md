##### 请用一句话总结一下mysql是什么？

Mysql是一个**关系型**的**数据库管理系统**，由Oracle Corporation开发和维护

##### Mysql索引是什么？有什么用？

索引（index）是一种**数据结构**，可以帮助Mysql高效**获取数据**

这个很好理解，**假如Mysql 是一本书**，里面的一篇篇文章就好比一条条数据，**索引就是书的目录**，你若想阅读书中某一篇文章，你可以先翻开目录，找到文章的页码，然后直接翻到相应的页码进行阅读。

##### 你知道Mysql索引有哪几种吗？

常见的索引有4种，分别是：PRIMARY KEY（主键索引），UNIQUE（唯一索引） INDEX（普通索引）和 FULLTEXT（全文索引），这几种都是使用B树实现的

**注：** B+树是B树的一种

##### 你刚才提到B树，那你说说B树平衡二叉树 有什么区别？为什么不用平衡二叉树实现索引呢？

平衡二叉树是一种左右树高度 <=1的二叉树，B树是多叉树。由于B树每个节点可以存多个元素，所以相同数据量情况下，B树的树高往往要小于二叉树的树高，数据检索的速度更快

注：数据检索总是从根节点开始，树的高度 = 磁盘I/O的次数

##### 使用和创建多列 索引（又称：复合索引）时需要注意什么？

最左原则：举例来说，如果你有一个三列的索引（co1,co2,co3），则在搜索条件是（co1）(co1,co2) (co1,co2,co3)的时候，都可以走索引查询

##### 索引下推是什么？

索引下推是**数据库检索数据**过程中为**减少回表次数**而做的**优化**

##### Mysql事务了解吗？ 说说它有哪些特征

注：InnoDB 支持事务，MyISAM 不支持

不假思索，道：ACID 分别是 原子性（Atomicity）、一致性（Consistency）

隔离性（lsolation）、持久性（Durability）

##### Mysql事务有几种隔离 级别呢？

四种，级别从低到高分别是：读未提交（Read uncommitted）、读已提交（read committed）、可重复读（repeatable table）、串行化（Serializable）

注：Mysql的默认隔离级别 是 可重复读（repeatable read）

##### 分别解释一下 脏读、不可重复读、幻读

- 脏读：是指一个**事务**读取到**另一个事务**修改后还没有COMMIT 的数据；
- 不可重复读：是指**一个事务多次**读取同一个数据，在多次读取之间有另外的事务对这一数据进行修改并COMMIT，导致多次读取同一个数据的结果不一致；
- 而是事务在插入事先检测不存在的记录时，惊奇的发现这些数据已经存在了，之前的检测读获取到的数据如同鬼影一般，例子：

1、T1：select * from users where id = 1;

2、T2：insert into `users`(`id`, `name`) values (1, 'big cat');

3、T1：insert into `users`(`id`, `name`) values (1, 'big cat');



##### Mysql共享锁（lock in share mode）排他锁（for update）

共享锁：

- 允许其他事务也增加共享锁读取
- 不允许其他事务增加排他锁（for update）
- 事务更新必须等待先执行的事务commit后才行，要不然很容易死锁

排他锁：

- 事务之间不允许其他排他锁或共享锁读取，修改更不可能
- 一次只能有一个排他锁执行commit之后，其他事务才可执行

##### Mysql的存储引擎有哪些？

常用的有InnoDB MyISAM 另外还有 MEMORY cdv ARCHIVE

##### 那你说说InnoDB 和 MyISAM 的区别

Innodb 支持事务， MyIsAM 不支持

Innodb 支持外健， MyIsAM 不支持

Innodb 是聚簇索引，MylsAM 是非聚簇索引（聚簇索引 ≠ 主键）

Innodb 不保持表总行数 MylsAM 保存

Innodb 最小的锁粒度是行锁，MylsAM 最小的锁粒度是表锁

##### 数据库使用外健的好处与坏处

好处：

- 使用外健可以降低开发的成本，借助数据库产品自身的触发器可以实现表与关联表之间的数据一致性和更新，
- 还可以做到开发人员和数据库设计人员的分工，可以为程序员承担更多的工作量

坏处：

- 数据库需要维护外健的内部管理
- 外健等于把数据的一致性事务实现，全部交给数据库服务器完成
- 有了外健，当做一些涉及外健字段的增，删，更新操作之后，需要触发相关操作去检查，而不得不消耗资源。
- 外健还会因为需要请求对其他表内部加锁而容易出现死锁情况

##### 你刚提到聚簇索引，它是怎么回事

每个innodb 表都有一个特殊的索引，称为聚簇索引，用于存储行数据。通常，聚簇索引就是主键索引；如果没有为表定义主键，则会选择一个NOT NULL的唯一索引 作为聚簇索引；如果符合条件的UNIQUe 也没有，则在innodb内部生成一个隐藏的聚集索引 GEN_CLUST_INDEX

注：通常我们会为每个innodb 表创建或选择一个 连续自增的列 作为主键，但是严格来讲，主键并不是必须的

##### Varchar(10) 和 char(10) 有什么区别

Varchar(10)和 char(10) 都代表字段最多可存储10个 字符，但它们被存储和检索的方式不同。它们的最大长度以及是否保留尾随空格也不同。

![](/Users/hpinke/Documents/img/pMDWW8n6EI.png)



##### 如果我往 CHAR(2) 列上设置值 ‘abcde’会怎样？

分两种情况 看看SQL 模式是否设置为严格 `select @@sql_mode;`查看严格

严格：不会存储值，并抛出异常。

不严格：则会将值截断存储，并抛出警告。例如这里会储存 ‘ab’

##### mysql 索引的优化

- **联合索引最左前缀原则**
- **不要在列上使用函数和进行运算**
- **负向条件查询不能使用索引** （负向条件有：!=、<>、not in、not exists、not like 等。）
- **使用覆盖索引** 所谓覆盖索引，是指被查询的列，数据能从索引中取得
- **避免强制类型转换**
- **范围列可以用到索引**  范围条件有：<、<=、>、>=、between 等
- **更新频繁、数据区分度不高的字段上不宜建立索引** 
- **索引列不允许为 null**
- **避免使用 or 来连接条件**
- **模糊查询**  前导模糊查询不能使用索引，非前导查询可以。











