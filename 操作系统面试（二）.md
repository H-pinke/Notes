##### 进程和线程的区别

进程(process)与线程(thread)最大的区别是进程是==一个实体==拥有自己的==地址空间== 一般情况下，包括文本区域，数据区域和堆栈。某个进程内的线程对于其他进程不可见，即进程A不能通过传地址的方式直接读写进程B的存储区域。进程之间的通信需要通过进程间通信（IPC :信号量、共享内存等等）与之相对的，同一进程的各线程之间可以直接通过传递地址或全局变量的方式传递信息。

此外，进程作为操作系统中拥有资源和独立调度的基本单位，可以拥有多个线程。通常操作系统中运行的一个程序对应一个进程。在同一进程中，线程的切换不会引起进程切换。在不同进程中进行线程切换，如从一个进程内的线程切换到另一个进程中的线程时，会引起进程切换。**相比进程切换**，**线程切换的开销要小很多**。线程与进程相互结合能够提高系统的运行效率。

==线程== 多进程解决了前面很多多任务问题，然而很多时候不同的程序需要共享同样的资源（文件、信号量等) 如果全部使用进程的话会导致切换的成本很高，造成CPU资源的浪费。于是就出现了线程的概念。

线程，有时被称为==轻量级进程==，是程序执行流的最小单元，没有独立的地址空间。一个标准的线程由线程ID，当前指令指针，寄存器集合和堆栈组成。

==协程== 又称微线程 协程可以理解为用户级线程，协程和线程的区别是：线程是抢占式调度，而协程是协同式的调度，协程避免了无意义的调度，由此可以提高性能，但也因此，程序员必须自己**承担调度**的**责任**，同时，协程也**失去**了标准线程使用**多CPU**的**能力**。

##### 上下文切换

对于**单核单线程**cpu而言，在某一时刻只能执行**一条CPU**指令。**上下文切换**是一种将**CPU资源**从**一个进程分配**给**另一个进程**的**机制**。从用户的角度看，计算机能够并行运行多个进程，这个恰恰是操作系统通过快速上下文切换造成的结果。在切换的**过程中**，操作系统需要先**存储当前进程的状态**(包括内存空间的指针，当前执行完的指令等等) **再读人下一个进程的状态**，然后**执行此进程**。

##### 进程间通信

本地进程间通信的方式有很多，可以总结为下面四类：

- 消息传递（管道、FIFO、消息队列）
- 同步（互斥量、条件变量、读写锁、文件和写记录锁、信号量）
- 共享内存（匿名的和具名的）
- 远程过程调用（solaris门和Sun RPC）

##### 进程的基本状态

1. 等待态：等待某个事件的完成；
2. 就绪态：等待系统分配处理器以便运行；
3. 运行态：占有处理器正在运行

运行态 $\rightarrow$ 等待态 往往是由于**等待外设**，等待**主存等资源**分配或等待**人工干预**而引起的。

等待态 $\rightarrow$ 就绪态 则是等待的**条件**已**满足**，只需要**分配**到**处理器**后就能运行

运行态 $\rightarrow$ 就绪态 **不是**由于**自身原因**，而是由**外界原因**使运行状态的进程**让出处理器**，这时候就变成就绪态。例如时间片用完，或者更高优先级的进程来抢占处理器等。

就绪态 $\rightarrow$ 运行态 系统按**某种策略**选中就绪队列中的一个**进程**占用**处理器**，此时就变成了运行态。

##### 非抢占式调度与抢占式调度

- 抢占式：操作系统将**正常**运行的**进程强行暂停**，由调度程序将CPU分配给其他**就绪进程**的调度方式。
- 非抢占式：分派**程序**一旦把**处理机**分配给**某个进程**后便让它**一直运行**下去，直到进程完成或发生进程调度某事件而阻塞时，才把处理机分配给另一个进程。

##### 死锁

死锁：**多个进程**因**循环等待资源**而造成**无法执行**的现象。

死锁会造成进程无法执行，同时会造成系统资源的极大浪费（资源无法释放）

死锁产生的4个必要条件：

- 互斥使用
    - [ ] 指进程对所分配到的资源进行排它性使用，即在一段时间内某资源只由一个进程占用。如果此时还有其他进程请求资源，则请求者只能等待，直至占有资源的进程用毕释放。
- 不可抢占
    - [ ] 指进程已获得资源，在未使用完之前，不能被剥夺，只能在使用完时由自己释放。
- 请求和保持
    - [ ] 指进程已经保持至少一个资源，但又提出了新的资源请求，而该资源已被其它进程占有，此时请求进程阻塞，但又对自己已获得的其他资源保存不放
- 循环等待
    - [ ] 指在发生死锁时，必然存在一个进程--资源的环形链

避免死锁-----==银行家算法==

思想：**判断**此次请求**是否造成死锁**，若会造成死锁，则**拒绝**该请求





